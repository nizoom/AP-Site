<script>
  console.log("script tag is running ");

  setTimeout(() => {
    const triggerElement = document.querySelector("#T3057851291 > div > div");
    triggerElement.addEventListener("click", observePageTransitions);
  }, 500);

  // Function to set up the MutationObserver
  function observePageTransitions() {
    console.log("Setting up the MutationObserver...");

    // Define the target node to observe (can be document.body or a specific container)
    const targetNode = document.body; // You can change this to a more specific part of the page

    // Options for the observer (which mutations to observe)
    const config = { childList: true, subtree: true };

    // Callback function that runs when a mutation is detected
    const mutationCallback = (mutationsList, observer) => {
      mutationsList.forEach((mutation) => {
        if (mutation.type === "childList") {
          console.log(
            "A page transition or DOM change has occurred!",
            mutation
          );
        }
      });
    };
    // Create an instance of MutationObserver and pass the callback
    const observer = new MutationObserver(mutationCallback);
    // Start observing the target node with the specified config
    observer.observe(targetNode, config);
    console.log("MutationObserver is now watching for page transitions.");
    if (checkForRequiredElements()) {
      alignBgColors();
    }
  }

  const checkForRequiredElements = () => {
    setTimeout(() => {
      const headerSectionElement = document.querySelector(
        "#K0174265030 > div > div"
      );

      const currentPageElement = getCurrentPageElement();
      //   console.log(backgroundElement);
      //   console.log(headerSectionElement);
      if (currentPageElement && headerSectionElement) {
        alignBgColors(currentPageElement, headerSectionElement);
      }
      return false;
    }, 100);
  };

  const getCurrentPageElement = () => {
    const pageIds = [
      "O0106132807",
      "F3645062839",
      "V2310587329",
      "H4280264991",
      "X0385859603",
      "S4102939361",
      "L3218446703",
    ];
    for (id of pageIds) {
      const potentialElement = document.querySelector(`#${id} > div > div`);
      if (potentialElement) {
        return potentialElement;
      }
    }
    console.log("typical page element not present ");
    return false;
  };
  const alignBgColors = (element1, element2) => {
    // console.log("setting colors");
    const pageBgColor = window
      .getComputedStyle(element1, null)
      .getPropertyValue("background-color");
    console.log(`computed style ${pageBgColor}`);
    element2.style.backgroundColor = pageBgColor;
  };
</script>
